{"cells":[{"cell_type":"markdown","source":["[사용칼럼] \n"," - 연속형 \n","   '다중이용업소여부', '철도_역_유무', '버스_터미널_유무', '가맹여부',\n","       '코로나여부', '상권여부', '대학교_유무', '백화점_유무', '폐업1년이내', '폐업3년이내', '시설총규모',\n","       '추정임대료', '집객시설_수', '관공서_수', '은행_수', '슈퍼마켓_수', '극장_수', '숙박_시설_수',\n","       '지하철_역_수', '버스_정거장_수', '총_생활인구_수', '아파트_단지_수', '의료기관_수', '교육기관_수',\n","       '생활인구_성별_비', '아파트_평당_가격', '총 상주인구 수', '상주인구_성별_비', '총 가구 수', '거주_유형_비',\n","       '점포당_매출_금액', '건수당_매출_금액', '점포수', '유사_업종_점포_수', '프랜차이즈_점포_수', '개업_율',\n","       '폐업_률', '선행종합지수', '소비자물가지수', '소비자심리지수', '중소기업대출금리'\n","\n"," - 범주형 -> 원핫인코딩\n","  '업종분류','상권변화_지표명','상권구분_코드명',시군구','생활인구_연령_대표','상주인구_연령_대표'\n","\n","\n","[모델 파라미터] (3년기준)\n"," - 이상치, 로그처리 X\n"," - x.shape = (30158,503) /  y.shape = (30158,)\n"," - 불균형데이터 처리 -> ADASYN\n"," - x_resampled.shape = (37774,503) / y_resampled.shape = (37774,)\n"," - train : val : test = 6:1:3\n","     => ---/f1/roc => ------ / 0.734/0.776\n","\n"," - Kfold - n_split = 5 \n","     => acc/f1/roc => 0.766 / 0.731/0.774\n","\n"," - Kfold - n_split = 4\n","     => acc/f1/roc => 0.765 / 0.730/0.773"],"metadata":{"id":"yvbaImC5TZAC"}},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"czUCZtfXa--V","executionInfo":{"status":"ok","timestamp":1658751086693,"user_tz":-540,"elapsed":21413,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"e86709c7-cb18-49be-edd9-49629cbdf0e4"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n","import pandas as pd\n","import numpy as np\n","import os\n","from glob import glob\n","import pickle\n","\n","from IPython.display import display, HTML\n","import warnings\n","warnings.filterwarnings(action='ignore')\n","\n","#데이터\n","from sklearn.datasets import load_iris, make_moons, load_breast_cancer\n","\n","import os\n","\n","#전처리\n","import numpy as np\n","import pandas as pd\n","from sklearn.preprocessing import PolynomialFeatures, StandardScaler\n","\n","#기계학습 모델 및 평가\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.model_selection import cross_val_score\n","from sklearn.model_selection import train_test_split\n","#classifier\n","from sklearn.svm import LinearSVC\n","from sklearn.svm import SVC\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.metrics import accuracy_score, recall_score, precision_score, f1_score, roc_auc_score\n","from sklearn.metrics import plot_confusion_matrix, classification_report\n","from tqdm import tqdm\n","from sklearn.model_selection import KFold\n","\n","#시각화\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","import matplotlib\n","from matplotlib.colors import ListedColormap\n","matplotlib.rcParams['axes.unicode_minus'] = False\n","\n","#"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9wI7YRYBbEpH","executionInfo":{"status":"ok","timestamp":1658751107503,"user_tz":-540,"elapsed":20815,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"158e05ae-4225-43c3-f224-bbb46be6c710"},"outputs":[{"output_type":"stream","name":"stdout","text":["Selecting previously unselected package fonts-nanum.\n","(Reading database ... 155653 files and directories currently installed.)\n","Preparing to unpack .../fonts-nanum_20170925-1_all.deb ...\n","Unpacking fonts-nanum (20170925-1) ...\n","Selecting previously unselected package fonts-nanum-eco.\n","Preparing to unpack .../fonts-nanum-eco_1.000-6_all.deb ...\n","Unpacking fonts-nanum-eco (1.000-6) ...\n","Selecting previously unselected package fonts-nanum-extra.\n","Preparing to unpack .../fonts-nanum-extra_20170925-1_all.deb ...\n","Unpacking fonts-nanum-extra (20170925-1) ...\n","Selecting previously unselected package fonts-nanum-coding.\n","Preparing to unpack .../fonts-nanum-coding_2.5-1_all.deb ...\n","Unpacking fonts-nanum-coding (2.5-1) ...\n","Setting up fonts-nanum-extra (20170925-1) ...\n","Setting up fonts-nanum (20170925-1) ...\n","Setting up fonts-nanum-coding (2.5-1) ...\n","Setting up fonts-nanum-eco (1.000-6) ...\n","Processing triggers for fontconfig (2.12.6-0ubuntu2) ...\n","sys_font number: 48\n","nanum_font number: 31\n","Python 3.7.13\n","설정 폰트 글꼴: ['sans-serif'], 설정 폰트 사이즈: 10.0\n","NanumGothic Eco\n"]}],"source":["%matplotlib inline  \n","\n","import matplotlib as mpl  # 기본 설정 만지는 용도\n","import matplotlib.pyplot as plt  # 그래프 그리는 용도\n","import matplotlib.font_manager as fm  # 폰트 관련 용도\n","\n","!apt-get update -qq\n","!apt-get install fonts-nanum* -qq\n","\n","sys_font=fm.findSystemFonts()\n","print(f\"sys_font number: {len(sys_font)}\")\n","\n","nanum_font = [f for f in sys_font if 'Nanum' in f]\n","print(f\"nanum_font number: {len(nanum_font)}\")\n","\n","!python --version\n","def current_font():\n","  print(f\"설정 폰트 글꼴: {plt.rcParams['font.family']}, 설정 폰트 사이즈: {plt.rcParams['font.size']}\")  # 파이썬 3.6 이상 사용가능하다\n","        \n","current_font()\n","\n","fm._rebuild()\n","\n","path = '/usr/share/fonts/truetype/nanum/NanumGothicEco.ttf'  # 설치된 나눔글꼴중 원하는 녀석의 전체 경로를 가져오자\n","font_name = fm.FontProperties(fname=path, size=10).get_name()\n","print(font_name)\n","plt.rc('font', family=font_name)"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":2568,"status":"ok","timestamp":1658751110067,"user":{"displayName":"민시온","userId":"03524457202412806393"},"user_tz":-540},"id":"kIb4BduAcfZA"},"outputs":[],"source":["df = pd.read_csv('/content/drive/MyDrive/통계 빅데이터 공모전/data/모델링용 최종본/이상_o_로그_o_원핫_o.csv')"]},{"cell_type":"code","source":["df.columns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ACeqeso_WPJq","executionInfo":{"status":"ok","timestamp":1658751110067,"user_tz":-540,"elapsed":13,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"b01dcbe5-2491-4ff8-c30a-71ff1bb7c23e"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['Unnamed: 0', '행정동', '상권코드', '인허가일자', '사업장명', '시군구코드', '행정동코드', '소재지수정',\n","       '폐업여부', '사업기간',\n","       ...\n","       '시군구_은평구', '시군구_종로구', '시군구_중구', '시군구_중랑구', '생활인구_연령_대표_노년층',\n","       '생활인구_연령_대표_중장년층/자녀', '생활인구_연령_대표_청년층', '상주인구_연령_대표_노년층',\n","       '상주인구_연령_대표_중장년층/자녀', '상주인구_연령_대표_청년층'],\n","      dtype='object', length=103)"]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["df['인허가일자']=pd.to_datetime(df['인허가일자'])"],"metadata":{"id":"-BDPxXiOWPHW","executionInfo":{"status":"ok","timestamp":1658751110068,"user_tz":-540,"elapsed":11,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["#3년 인덱스\n","inindex=df[df['인허가일자']<'2020-01-02'].index\n","#2020년 이후 폐업 인덱스\n","overindex=df.loc[df['인허가일자']>='2020-01-02'][df.loc[df['인허가일자']>='2020-01-02','폐업3년이내']==1].index\n","ind=list(inindex)\n","ond=list(overindex)\n","#3년이내 폐업 최종 인덱스\n","ind.extend(ond)\n","len(ind)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bXvhbtZ7WUv_","executionInfo":{"status":"ok","timestamp":1658751110068,"user_tz":-540,"elapsed":11,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"27a532c4-299c-413a-81b2-70a0b01d533b"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["30158"]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["df=df[['Unnamed: 0', '상권코드', '인허가일자', '사업장명', '시군구코드', '행정동코드', '소재지수정',\n","       '폐업여부', '사업기간', '현재영업여부','행정동', '인허가분기', '인허가년도', '다중이용업소여부', '철도_역_수',\n","       '버스_터미널_수', '가맹여부', '코로나여부', '상권여부', '대학교_유무', '백화점_유무', '폐업1년이내',\n","       '폐업3년이내', '시설총규모', '추정임대료', '집객시설_수', '관공서_수', '은행_수', '슈퍼마켓_수', '극장_수',\n","       '숙박_시설_수', '지하철_역_수', '버스_정거장_수', '총_생활인구_수', '아파트_단지_수', '의료기관_수',\n","       '교육기관_수', '생활인구_성별_비', '아파트_평당_가격', '총 상주인구 수', '상주인구_성별_비', '총 가구 수',\n","       '거주_유형_비', '점포당_매출_금액', '건수당_매출_금액', '점포수', '유사_업종_점포_수', '프랜차이즈_점포_수',\n","       '개업_율',  '폐업_률','선행종합지수', '소비자물가지수', '소비자심리지수', '중소기업대출금리', '업종분류_기타', '업종분류_분식전문점',\n","       '업종분류_양식음식점', '업종분류_일식음식점', '업종분류_중식음식점', '업종분류_치킨전문점', '업종분류_커피-음료',\n","       '업종분류_패스트푸드점', '업종분류_한식음식점', '업종분류_호프-간이주점', '상권변화_지표명_다이나믹',\n","       '상권변화_지표명_상권축소', '상권변화_지표명_상권확장', '상권변화_지표명_정체', '상권구분_코드명_골목상권',\n","       '상권구분_코드명_관광특구', '상권구분_코드명_발달상권', '상권구분_코드명_전통시장', '시군구_강남구', '시군구_강동구',\n","       '시군구_강북구', '시군구_강서구', '시군구_관악구', '시군구_광진구', '시군구_구로구', '시군구_금천구',\n","       '시군구_노원구', '시군구_도봉구', '시군구_동대문구', '시군구_동작구', '시군구_마포구', '시군구_서대문구',\n","       '시군구_서초구', '시군구_성동구', '시군구_성북구', '시군구_송파구', '시군구_양천구', '시군구_영등포구',\n","       '시군구_용산구', '시군구_은평구', '시군구_종로구', '시군구_중구', '시군구_중랑구', '생활인구_연령_대표_노년층',\n","       '생활인구_연령_대표_중장년층/자녀', '생활인구_연령_대표_청년층', '상주인구_연령_대표_노년층',\n","       '상주인구_연령_대표_중장년층/자녀', '상주인구_연령_대표_청년층']]"],"metadata":{"id":"seTWreuwWUt4","executionInfo":{"status":"ok","timestamp":1658751110069,"user_tz":-540,"elapsed":8,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["df.loc[:,'인허가년도'] = df['인허가년도'].astype(str)"],"metadata":{"id":"k5E5BcGHWUq-","executionInfo":{"status":"ok","timestamp":1658751110069,"user_tz":-540,"elapsed":8,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["li = ['행정동', '인허가년도']\n","for i in li:\n","  df=pd.get_dummies(data=df, columns = [i], prefix=i)"],"metadata":{"id":"irGtpPIRWUlS","executionInfo":{"status":"ok","timestamp":1658751110732,"user_tz":-540,"elapsed":670,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["colname = ['집객시설_수','관공서_수','은행_수','슈퍼마켓_수','극장_수','숙박_시설_수','지하철_역_수','버스_정거장_수','아파트_단지_수','의료기관_수','교육기관_수','점포수','유사_업종_점포_수','프랜차이즈_점포_수']"],"metadata":{"id":"NN5Ld0JlWPFA","executionInfo":{"status":"ok","timestamp":1658751110732,"user_tz":-540,"elapsed":15,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["df['철도_역_수'] = df['철도_역_수'].apply(lambda x:1 if x > 0 else 0)\n","df['버스_터미널_수'] = df['버스_터미널_수'].apply(lambda x:1 if x > 0 else 0)\n","df= df.rename(columns={'철도_역_수':'철도역_유무','버스_터미널_수':'버스터미널_유무'})"],"metadata":{"id":"KVsXDYXpWPC3","executionInfo":{"status":"ok","timestamp":1658751110733,"user_tz":-540,"elapsed":15,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["for col in colname:\n","  df.loc[:,col] = df[col]/df['총_생활인구_수']"],"metadata":{"id":"4hRl9cLxWPAz","executionInfo":{"status":"ok","timestamp":1658751110733,"user_tz":-540,"elapsed":15,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["colname = ['집객시설_수','관공서_수','은행_수','슈퍼마켓_수','극장_수','숙박_시설_수','지하철_역_수','버스_정거장_수','아파트_단지_수','의료기관_수','교육기관_수','점포수','유사_업종_점포_수','프랜차이즈_점포_수','총_생활인구_수']\n","df.loc[:,colname]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"mfyA4U1kWO-c","executionInfo":{"status":"ok","timestamp":1658751110734,"user_tz":-540,"elapsed":15,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"3caf81ff-0fca-4780-f0f6-6878ae9c7e99"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         집객시설_수     관공서_수      은행_수    슈퍼마켓_수     극장_수   숙박_시설_수   지하철_역_수  \\\n","0      0.007947  0.001295  0.001495  0.000000  0.00134  0.002982  0.001295   \n","1      0.003963  0.000000  0.000000  0.000000  0.00000  0.000000  0.000000   \n","2      0.007629  0.001381  0.002584  0.000677  0.00000  0.001572  0.000977   \n","3      0.002186  0.000000  0.000000  0.000000  0.00000  0.001244  0.000000   \n","4      0.002460  0.000820  0.000580  0.000000  0.00000  0.000402  0.000000   \n","...         ...       ...       ...       ...      ...       ...       ...   \n","45697  0.004195  0.001164  0.000000  0.000000  0.00000  0.000000  0.000000   \n","45698  0.006228  0.000000  0.000804  0.000000  0.00000  0.000000  0.001393   \n","45699  0.005410  0.000000  0.002482  0.000000  0.00000  0.000000  0.000000   \n","45700  0.005410  0.000000  0.002482  0.000000  0.00000  0.000000  0.000000   \n","45701  0.002222  0.000510  0.000000  0.000000  0.00000  0.000000  0.000000   \n","\n","       버스_정거장_수  아파트_단지_수    의료기관_수    교육기관_수       점포수  유사_업종_점포_수  \\\n","0      0.002480  0.002364  0.002364  0.000000  0.004196    0.003965   \n","1      0.001868  0.007472  0.001868  0.000000  0.003662    0.003282   \n","2      0.003522  0.002584  0.003089  0.000000  0.005232    0.004769   \n","3      0.001339  0.007373  0.000773  0.000000  0.003202    0.002725   \n","4      0.001420  0.005740  0.001160  0.000000  0.002946    0.002693   \n","...         ...       ...       ...       ...       ...         ...   \n","45697  0.000000  0.007172  0.001645  0.000000  0.004201    0.003542   \n","45698  0.003315  0.005570  0.002667  0.001393  0.003635    0.002966   \n","45699  0.002150  0.007130  0.002482  0.000000  0.003441    0.003779   \n","45700  0.002150  0.007130  0.002482  0.000000  0.006367    0.005423   \n","45701  0.000883  0.006095  0.000883  0.000721  0.001668    0.001380   \n","\n","       프랜차이즈_점포_수     총_생활인구_수  \n","0        0.002240  1337.613547  \n","1        0.001831   757.097748  \n","2        0.002767  1023.764133  \n","3        0.000536  1293.871323  \n","4        0.000933  1724.673012  \n","...           ...          ...  \n","45697    0.000000   859.455642  \n","45698    0.001767  1243.801431  \n","45699    0.000000   805.740033  \n","45700    0.002415   805.740033  \n","45701    0.000384  1962.040519  \n","\n","[45702 rows x 15 columns]"],"text/html":["\n","  <div id=\"df-1eeacb8e-7b42-49b1-a0e1-a0cc5233f905\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>집객시설_수</th>\n","      <th>관공서_수</th>\n","      <th>은행_수</th>\n","      <th>슈퍼마켓_수</th>\n","      <th>극장_수</th>\n","      <th>숙박_시설_수</th>\n","      <th>지하철_역_수</th>\n","      <th>버스_정거장_수</th>\n","      <th>아파트_단지_수</th>\n","      <th>의료기관_수</th>\n","      <th>교육기관_수</th>\n","      <th>점포수</th>\n","      <th>유사_업종_점포_수</th>\n","      <th>프랜차이즈_점포_수</th>\n","      <th>총_생활인구_수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.007947</td>\n","      <td>0.001295</td>\n","      <td>0.001495</td>\n","      <td>0.000000</td>\n","      <td>0.00134</td>\n","      <td>0.002982</td>\n","      <td>0.001295</td>\n","      <td>0.002480</td>\n","      <td>0.002364</td>\n","      <td>0.002364</td>\n","      <td>0.000000</td>\n","      <td>0.004196</td>\n","      <td>0.003965</td>\n","      <td>0.002240</td>\n","      <td>1337.613547</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.003963</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.001868</td>\n","      <td>0.007472</td>\n","      <td>0.001868</td>\n","      <td>0.000000</td>\n","      <td>0.003662</td>\n","      <td>0.003282</td>\n","      <td>0.001831</td>\n","      <td>757.097748</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.007629</td>\n","      <td>0.001381</td>\n","      <td>0.002584</td>\n","      <td>0.000677</td>\n","      <td>0.00000</td>\n","      <td>0.001572</td>\n","      <td>0.000977</td>\n","      <td>0.003522</td>\n","      <td>0.002584</td>\n","      <td>0.003089</td>\n","      <td>0.000000</td>\n","      <td>0.005232</td>\n","      <td>0.004769</td>\n","      <td>0.002767</td>\n","      <td>1023.764133</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.002186</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.001244</td>\n","      <td>0.000000</td>\n","      <td>0.001339</td>\n","      <td>0.007373</td>\n","      <td>0.000773</td>\n","      <td>0.000000</td>\n","      <td>0.003202</td>\n","      <td>0.002725</td>\n","      <td>0.000536</td>\n","      <td>1293.871323</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.002460</td>\n","      <td>0.000820</td>\n","      <td>0.000580</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000402</td>\n","      <td>0.000000</td>\n","      <td>0.001420</td>\n","      <td>0.005740</td>\n","      <td>0.001160</td>\n","      <td>0.000000</td>\n","      <td>0.002946</td>\n","      <td>0.002693</td>\n","      <td>0.000933</td>\n","      <td>1724.673012</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>45697</th>\n","      <td>0.004195</td>\n","      <td>0.001164</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.007172</td>\n","      <td>0.001645</td>\n","      <td>0.000000</td>\n","      <td>0.004201</td>\n","      <td>0.003542</td>\n","      <td>0.000000</td>\n","      <td>859.455642</td>\n","    </tr>\n","    <tr>\n","      <th>45698</th>\n","      <td>0.006228</td>\n","      <td>0.000000</td>\n","      <td>0.000804</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.001393</td>\n","      <td>0.003315</td>\n","      <td>0.005570</td>\n","      <td>0.002667</td>\n","      <td>0.001393</td>\n","      <td>0.003635</td>\n","      <td>0.002966</td>\n","      <td>0.001767</td>\n","      <td>1243.801431</td>\n","    </tr>\n","    <tr>\n","      <th>45699</th>\n","      <td>0.005410</td>\n","      <td>0.000000</td>\n","      <td>0.002482</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.002150</td>\n","      <td>0.007130</td>\n","      <td>0.002482</td>\n","      <td>0.000000</td>\n","      <td>0.003441</td>\n","      <td>0.003779</td>\n","      <td>0.000000</td>\n","      <td>805.740033</td>\n","    </tr>\n","    <tr>\n","      <th>45700</th>\n","      <td>0.005410</td>\n","      <td>0.000000</td>\n","      <td>0.002482</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.002150</td>\n","      <td>0.007130</td>\n","      <td>0.002482</td>\n","      <td>0.000000</td>\n","      <td>0.006367</td>\n","      <td>0.005423</td>\n","      <td>0.002415</td>\n","      <td>805.740033</td>\n","    </tr>\n","    <tr>\n","      <th>45701</th>\n","      <td>0.002222</td>\n","      <td>0.000510</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.00000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000883</td>\n","      <td>0.006095</td>\n","      <td>0.000883</td>\n","      <td>0.000721</td>\n","      <td>0.001668</td>\n","      <td>0.001380</td>\n","      <td>0.000384</td>\n","      <td>1962.040519</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>45702 rows × 15 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1eeacb8e-7b42-49b1-a0e1-a0cc5233f905')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1eeacb8e-7b42-49b1-a0e1-a0cc5233f905 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1eeacb8e-7b42-49b1-a0e1-a0cc5233f905');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["import imblearn\n","print(imblearn.__version__)\n","\n","import pandas as pd\n","from collections import Counter\n","from matplotlib import pyplot\n","\n","\n","# 필요 함수 정의\n","def count_and_plot(y): \n","    counter = Counter(y)\n","    for k,v in counter.items():\n","        print('Class=%d, n=%d (%.3f%%)' % (k, v, v / len(y) * 100))\n","    pyplot.bar(counter.keys(), counter.values())\n","    pyplot.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mLBMjESMW2ta","executionInfo":{"status":"ok","timestamp":1658751111185,"user_tz":-540,"elapsed":464,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"eae6d8ae-42d6-4e40-8dc7-905275125f17"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["0.8.1\n"]}]},{"cell_type":"code","source":["df_input = df.iloc[ind, 11:] #인허가분기도 제외\n","#df_input =df_input.loc[:,col] #시군구 제외용"],"metadata":{"id":"fCTw13oBW2ov","executionInfo":{"status":"ok","timestamp":1658751111685,"user_tz":-540,"elapsed":3,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["y = df_input.pop('폐업3년이내')\n","df_input.pop('폐업1년이내')\n","\n","X = df_input"],"metadata":{"id":"DSBu39agW2mt","executionInfo":{"status":"ok","timestamp":1658751112046,"user_tz":-540,"elapsed":1,"user":{"displayName":"민시온","userId":"03524457202412806393"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["from imblearn.over_sampling import ADASYN\n","X_resampled, y_resampled = ADASYN(random_state=0).fit_resample(X, y)\n","count_and_plot(y_resampled)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":321},"id":"iS8rzHu5W2ku","executionInfo":{"status":"ok","timestamp":1658751153296,"user_tz":-540,"elapsed":40426,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"c5af2694-a90f-4812-c79d-6f51996078f6"},"execution_count":17,"outputs":[{"output_type":"stream","name":"stderr","text":["findfont: Font family ['NanumGothic Eco'] not found. Falling back to DejaVu Sans.\n"]},{"output_type":"stream","name":"stdout","text":["Class=1, n=19246 (51.687%)\n","Class=0, n=17990 (48.313%)\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYMAAAD6CAYAAABDPiuvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAWAUlEQVR4nO3df5Bd9Xnf8fcnIhDbsYswG40igSVcORnwJLLZwYxjuzjEIEhr4bZDxbRGdohlakjjSWdqCH/gwWFK2jhumbp4ZFtjMeOAiTFFTeRimeC4HVfAYsuAsLEWGQZpBNogYpKSwYE8/eN+1zks+0t7d+9K0fs1c+ae+5wf97lnd/XZc75nr1JVSJKObT+12A1IkhafYSBJMgwkSYaBJAnDQJKEYSBJYhZhkOSUJPckeSTJ7iS/3eonJdmRZE97XNrqSXJjktEkDyZ5a2dfG9v6e5Js7NTPTPJQ2+bGJFmINytJmlxm+juDJMuB5VX17SSvBR4ALgI+AByqqhuSXAUsraqPJbkQ+C3gQuBtwH+tqrclOQkYAYaBavs5s6qeTXIf8O+Ae4HtwI1V9dXp+jr55JNr1apVc33fknRMeuCBB/6iqoYm1o+bacOqOgAcaPN/leR7wApgPXBOW20r8A3gY61+c/VSZmeSE1ugnAPsqKpDAEl2AOuSfAN4XVXtbPWb6YXNtGGwatUqRkZGZmpfktSR5InJ6oc1ZpBkFfAWer/BL2tBAfAUsKzNrwCe7Gy2r9Wmq++bpC5JGpBZh0GSnwVuBz5aVc91l7WzgAX/XIskm5KMJBkZGxtb6JeTpGPGrMIgyU/TC4IvVtVXWvnpdvlnfFzhYKvvB07pbL6y1aarr5yk/gpVtbmqhqtqeGjoFZe8JElzNJu7iQJ8HvheVf1hZ9E2YPyOoI3AnZ36pe2uorOBH7XLSXcB5yVZ2u48Og+4qy17LsnZ7bUu7exLkjQAMw4gA78CvB94KMmuVvtd4AbgtiSXAU8AF7dl2+ndSTQKPA98EKCqDiX5BHB/W++68cFk4CPAF4BX0Rs4nnbwWJI0v2a8tfRINTw8XN5NJEmHJ8kDVTU8se5fIEuSDANJkmEgSWJ2A8iSBmzVVX+62C3oCPX4Db++IPv1zECSZBhIkgwDSRKGgSQJw0CShGEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkiWP0g+r8EDBNZaE+BEw60nlmIEmaOQySbElyMMnDndqXkuxq0+Pj/zdyklVJ/qaz7DOdbc5M8lCS0SQ3Jkmrn5RkR5I97XHpQrxRSdLUZnNm8AVgXbdQVf+qqtZW1VrgduArncWPjS+rqss79ZuADwFr2jS+z6uAu6tqDXB3ey5JGqAZw6CqvgkcmmxZ++3+YuCW6faRZDnwuqraWVUF3Axc1BavB7a2+a2duiRpQPodM3gn8HRV7enUVif5TpI/T/LOVlsB7Ouss6/VAJZV1YE2/xSwrM+eJEmHqd+7iS7h5WcFB4BTq+qZJGcC/yPJGbPdWVVVkppqeZJNwCaAU089dY4tS5ImmvOZQZLjgH8OfGm8VlUvVNUzbf4B4DHgTcB+YGVn85WtBvB0u4w0fjnp4FSvWVWbq2q4qoaHhobm2rokaYJ+LhP9GvD9qvrJ5Z8kQ0mWtPnT6A0U722XgZ5LcnYbZ7gUuLNttg3Y2OY3duqSpAGZza2ltwD/F/iFJPuSXNYWbeCVA8fvAh5st5p+Gbi8qsYHnz8CfA4YpXfG8NVWvwF4T5I99ALmhj7ejyRpDmYcM6iqS6aof2CS2u30bjWdbP0R4M2T1J8Bzp2pD0nSwvEvkCVJhoEkyTCQJGEYSJIwDCRJGAaSJAwDSRKGgSQJw0CShGEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkCcNAkoRhIElidv8H8pYkB5M83Kl9PMn+JLvadGFn2dVJRpM8muT8Tn1dq40muapTX53k3lb/UpLj5/MNSpJmNpszgy8A6yapf6qq1rZpO0CS04ENwBltm/+eZEmSJcCngQuA04FL2roAv9/29Y+BZ4HL+nlDkqTDN2MYVNU3gUOz3N964NaqeqGqfgiMAme1abSq9lbVj4FbgfVJAvwq8OW2/VbgosN8D5KkPvUzZnBlkgfbZaSlrbYCeLKzzr5Wm6r+euAvq+rFCfVJJdmUZCTJyNjYWB+tS5K65hoGNwFvBNYCB4BPzltH06iqzVU1XFXDQ0NDg3hJSTomHDeXjarq6fH5JJ8F/qQ93Q+c0ll1ZasxRf0Z4MQkx7Wzg+76kqQBmdOZQZLlnafvA8bvNNoGbEhyQpLVwBrgPuB+YE27c+h4eoPM26qqgHuAf9m23wjcOZeeJElzN+OZQZJbgHOAk5PsA64FzkmyFijgceDDAFW1O8ltwCPAi8AVVfVS28+VwF3AEmBLVe1uL/Ex4NYkvwd8B/j8vL07SdKszBgGVXXJJOUp/8GuquuB6yepbwe2T1LfS+9uI0nSIvEvkCVJhoEkyTCQJGEYSJIwDCRJGAaSJAwDSRKGgSQJw0CShGEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkCcNAkoRhIEliFmGQZEuSg0ke7tT+c5LvJ3kwyR1JTmz1VUn+JsmuNn2ms82ZSR5KMprkxiRp9ZOS7Eiypz0uXYg3Kkma2mzODL4ArJtQ2wG8uap+CfgBcHVn2WNVtbZNl3fqNwEfAta0aXyfVwF3V9Ua4O72XJI0QDOGQVV9Ezg0ofa1qnqxPd0JrJxuH0mWA6+rqp1VVcDNwEVt8Xpga5vf2qlLkgZkPsYMfgP4auf56iTfSfLnSd7ZaiuAfZ119rUawLKqOtDmnwKWTfVCSTYlGUkyMjY2Ng+tS5KgzzBIcg3wIvDFVjoAnFpVbwF+B/ijJK+b7f7aWUNNs3xzVQ1X1fDQ0FAfnUuSuo6b64ZJPgD8U+Dc9o84VfUC8EKbfyDJY8CbgP28/FLSylYDeDrJ8qo60C4nHZxrT5KkuZnTmUGSdcB/AN5bVc936kNJlrT50+gNFO9tl4GeS3J2u4voUuDOttk2YGOb39ipS5IGZMYzgyS3AOcAJyfZB1xL7+6hE4Ad7Q7Rne3OoXcB1yX5W+DvgMuranzw+SP07kx6Fb0xhvFxhhuA25JcBjwBXDwv70ySNGszhkFVXTJJ+fNTrHs7cPsUy0aAN09SfwY4d6Y+JEkLx79AliQZBpIkw0CShGEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkCcNAkoRhIEnCMJAkYRhIkjAMJEkYBpIkDANJEoaBJIlZhkGSLUkOJnm4UzspyY4ke9rj0lZPkhuTjCZ5MMlbO9tsbOvvSbKxUz8zyUNtmxvT/mNlSdJgzPbM4AvAugm1q4C7q2oNcHd7DnABsKZNm4CboBcewLXA24CzgGvHA6St86HOdhNfS5K0gGYVBlX1TeDQhPJ6YGub3wpc1KnfXD07gROTLAfOB3ZU1aGqehbYAaxry15XVTurqoCbO/uSJA1AP2MGy6rqQJt/CljW5lcAT3bW29dq09X3TVJ/hSSbkowkGRkbG+ujdUlS17wMILff6Gs+9jXD62yuquGqGh4aGlrol5OkY0Y/YfB0u8RDezzY6vuBUzrrrWy16eorJ6lLkgaknzDYBozfEbQRuLNTv7TdVXQ28KN2Oeku4LwkS9vA8XnAXW3Zc0nObncRXdrZlyRpAI6bzUpJbgHOAU5Oso/eXUE3ALcluQx4Ari4rb4duBAYBZ4HPghQVYeSfAK4v613XVWND0p/hN4dS68CvtomSdKAzCoMquqSKRadO8m6BVwxxX62AFsmqY8Ab55NL5Kk+edfIEuSDANJkmEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkCcNAkoRhIEnCMJAkYRhIkjAMJEkYBpIkDANJEoaBJAnDQJJEH2GQ5BeS7OpMzyX5aJKPJ9nfqV/Y2ebqJKNJHk1yfqe+rtVGk1zV75uSJB2eWf0fyJOpqkeBtQBJlgD7gTuADwKfqqo/6K6f5HRgA3AG8PPA15O8qS3+NPAeYB9wf5JtVfXIXHuTJB2eOYfBBOcCj1XVE0mmWmc9cGtVvQD8MMkocFZbNlpVewGS3NrWNQwkaUDma8xgA3BL5/mVSR5MsiXJ0lZbATzZWWdfq01Vf4Ukm5KMJBkZGxubp9YlSX2HQZLjgfcCf9xKNwFvpHcJ6QDwyX5fY1xVba6q4aoaHhoamq/dStIxbz4uE10AfLuqngYYfwRI8lngT9rT/cApne1WthrT1CVJAzAfl4kuoXOJKMnyzrL3AQ+3+W3AhiQnJFkNrAHuA+4H1iRZ3c4yNrR1JUkD0teZQZLX0LsL6MOd8n9KshYo4PHxZVW1O8lt9AaGXwSuqKqX2n6uBO4ClgBbqmp3P31Jkg5PX2FQVf8PeP2E2vunWf964PpJ6tuB7f30IkmaO/8CWZJkGEiSDANJEoaBJAnDQJKEYSBJwjCQJGEYSJIwDCRJGAaSJAwDSRKGgSQJw0CShGEgScIwkCRhGEiSMAwkSRgGkiTmIQySPJ7koSS7koy02klJdiTZ0x6XtnqS3JhkNMmDSd7a2c/Gtv6eJBv77UuSNHvzdWbw7qpaW1XD7flVwN1VtQa4uz0HuABY06ZNwE3QCw/gWuBtwFnAteMBIklaeAt1mWg9sLXNbwUu6tRvrp6dwIlJlgPnAzuq6lBVPQvsANYtUG+SpAnmIwwK+FqSB5JsarVlVXWgzT8FLGvzK4AnO9vua7Wp6i+TZFOSkSQjY2Nj89C6JAnguHnYxzuqan+SnwN2JPl+d2FVVZKah9ehqjYDmwGGh4fnZZ+SpHk4M6iq/e3xIHAHvWv+T7fLP7THg231/cApnc1XttpUdUnSAPQVBklek+S14/PAecDDwDZg/I6gjcCdbX4bcGm7q+hs4EftctJdwHlJlraB4/NaTZI0AP1eJloG3JFkfF9/VFX/K8n9wG1JLgOeAC5u628HLgRGgeeBDwJU1aEknwDub+tdV1WH+uxNkjRLfYVBVe0FfnmS+jPAuZPUC7hiin1tAbb0048kaW78C2RJkmEgSTIMJEkYBpIkDANJEoaBJAnDQJKEYSBJwjCQJGEYSJIwDCRJGAaSJAwDSRKGgSQJw0CShGEgScIwkCTRRxgkOSXJPUkeSbI7yW+3+seT7E+yq00Xdra5OslokkeTnN+pr2u10SRX9feWJEmHq5//9vJF4N9X1beTvBZ4IMmOtuxTVfUH3ZWTnA5sAM4Afh74epI3tcWfBt4D7APuT7Ktqh7pozdJ0mGYcxhU1QHgQJv/qyTfA1ZMs8l64NaqegH4YZJR4Ky2bLT9f8okubWtaxhI0oDMy5hBklXAW4B7W+nKJA8m2ZJkaautAJ7sbLav1aaqS5IGpO8wSPKzwO3AR6vqOeAm4I3AWnpnDp/s9zU6r7UpyUiSkbGxsfnarSQd8/oKgyQ/TS8IvlhVXwGoqqer6qWq+jvgs/z9paD9wCmdzVe22lT1V6iqzVU1XFXDQ0ND/bQuSero526iAJ8HvldVf9ipL++s9j7g4Ta/DdiQ5IQkq4E1wH3A/cCaJKuTHE9vkHnbXPuSJB2+fu4m+hXg/cBDSXa12u8ClyRZCxTwOPBhgKraneQ2egPDLwJXVNVLAEmuBO4ClgBbqmp3H31Jkg5TP3cT/R8gkyzaPs021wPXT1LfPt12kqSF5V8gS5IMA0mSYSBJwjCQJGEYSJIwDCRJGAaSJAwDSRKGgSQJw0CShGEgScIwkCRhGEiSMAwkSRgGkiQMA0kShoEkCcNAksQRFAZJ1iV5NMlokqsWux9JOpYcEWGQZAnwaeAC4HTgkiSnL25XknTsOCLCADgLGK2qvVX1Y+BWYP0i9yRJx4wjJQxWAE92nu9rNUnSABy32A0cjiSbgE3t6V8neXQx+5nBycBfLHYTs3S09Lrgfeb352U3Hs/5d7T0ejR8j75hsuKREgb7gVM6z1e22stU1WZg86Ca6keSkaoaXuw+ZuNo6dU+59fR0iccPb0eLX1O5ki5THQ/sCbJ6iTHAxuAbYvckyQdM46IM4OqejHJlcBdwBJgS1XtXuS2JOmYcUSEAUBVbQe2L3Yf8+iouJzVHC292uf8Olr6hKOn16Olz1dIVS12D5KkRXakjBlIkhaRYTAH6bmxfXTGg0neOsk6r07yp0m+n2R3khs6yz6QZCzJrjb95gL1Oe1HfCQ5IcmX2vJ7k6zqLLu61R9Ncv5C9HcYff5Okkfasb47yRs6y17qHMcFv+lgFr1O+bVNsjHJnjZtXOQ+P9Xp8QdJ/rKzbGDHNMmWJAeTPDzF8il/1gZ8PGfq81+3/h5K8q0kv9xZ9nir70oyspB99qWqnA5zAi4EvgoEOBu4d5J1Xg28u80fD/xv4IL2/APAf1vgHpcAjwGntdf/LnD6hHU+AnymzW8AvtTmT2/rnwCsbvtZsoh9vht4dZv/t+N9tud/PcCv+2x6nfRrC5wE7G2PS9v80sXqc8L6v0Xvpo3FOKbvAt4KPDzF8kl/1gZ5PGfZ59vHX5/ex+rc21n2OHDyoI7pXCfPDOZmPXBz9ewETkyyvLtCVT1fVfe0+R8D36b39xODMpuP+FgPbG3zXwbOTZJWv7WqXqiqHwKjbX+L0mdV3VNVz7enOxnscezq52NTzgd2VNWhqnoW2AGsO0L6vAS4ZYF6mVZVfRM4NM0qU/2sDfJ4zthnVX2r9QGL+z06Z4bB3BzWx2ckORH4Z8DdnfK/aKeVX05yyhSbLnSPP1mnql4EfgS8fpbbDrLPrsvo/aY47meSjCTZmeSihWiwY7a9Tva1PSKPabvkthr4s055kMd0JlO9lyP5I2wmfo8W8LUkD6T3KQpHpCPm1tJ/qJIcR++3rhuram8r/0/glqp6IcmH6f12/quL1ePRIsm/AYaBf9Ipv6Gq9ic5DfizJA9V1WOL0yFw9H1tNwBfrqqXOrUj7ZgeNZK8m14YvKNTfkc7nj8H7Ejy/XamcUTxzGCWklwxPqgGHGAWH5/RbAb2VNV/GS9U1TNV9UJ7+jngzAVoeTYf8fGTdVpo/SPgmVluO8g+SfJrwDXAezvHjqra3x73At8A3rJAfc6q12m+tkfcMW02MOES0YCP6Uymei+DPJ6zkuSX6H3N11fVM+P1zvE8CNzBwl1y7c9iD1ocjRPw67x8UOu+Kdb7PeB24Kcm1Jd35t8H7FyAHo+jN6i2mr8fRDxjwjpX8PIB5Nva/Bm8fAB5Lws3gDybPt9Cb0B0zYT6UuCENn8ysIdpBkoH1OukX1t6A50/bD0vbfMnLVafbb1fpDe4mcU6pu11VjH1wOykP2uDPJ6z7PNUemNrb59Qfw3w2s78t4B1C9nnnN/fYjdwNE7tG/PT7R+oh4DhzrJd7XElvWuF3wN2tek327L/COxuP6T3AL+4QH1eCPyg9XlNq11H77drgJ8B/rh9E98HnNbZ9pq23aO0u6AW8HjO1OfXgac7x3Fbq7+9Hf/vtsfLBvC1n6nXKb+2wG+0Yz0KfHAx+2zPPw7cMGG7gR5TemclB4C/pXfd/zLgcuDytny6n7VBHs+Z+vwc8Gzne3Sk1U9rx/K77fvimoX+Hp3r5F8gS5IcM5AkGQaSJAwDSRKGgSQJw0CShGEgScIwkCRhGEiSgP8PM9N3jaUPw3sAAAAASUVORK5CYII=\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["X_train,X_test,y_train,y_test = train_test_split(X_resampled,y_resampled,test_size=0.4,random_state=11)\n","X_val,X_test,y_val,y_test = train_test_split(X_test,y_test,test_size=0.75,random_state=11)\n","print(X_train.shape, X_val.shape, X_test.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UfkQ7MBjW2ij","executionInfo":{"status":"ok","timestamp":1658751153790,"user_tz":-540,"elapsed":498,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"90a3ead3-d255-45ca-fa4c-0172840a880d"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["(22341, 499) (3723, 499) (11172, 499)\n"]}]},{"cell_type":"code","source":["C=1000\n","svc_rbf = SVC(random_state = 11, probability=True, kernel=\"rbf\", gamma='auto', C=C)\n","\n","svc_rbf.fit(X_train, y_train)"],"metadata":{"id":"vLCL2vaMFhCy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1658757363084,"user_tz":-540,"elapsed":6209295,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"5323238f-e7d0-41c8-e0bf-269f9758a9ad"},"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["SVC(C=1000, gamma='auto', probability=True, random_state=11)"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["y_true, y_pred = y_test, svc_rbf.predict(X_test)\n","print(classification_report(y_true, y_pred))\n","print()"],"metadata":{"id":"mdnD3Ma1FhAu","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1658757565894,"user_tz":-540,"elapsed":202816,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"7a81b6b6-5b27-422a-ed1c-8e3a4f51e879"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.65      0.28      0.40      5354\n","           1       0.57      0.86      0.68      5818\n","\n","    accuracy                           0.58     11172\n","   macro avg       0.61      0.57      0.54     11172\n","weighted avg       0.61      0.58      0.54     11172\n","\n","\n"]}]},{"cell_type":"code","source":["acc = accuracy_score(y_true = y_test, y_pred=y_pred) ##정밀도\n","f_score = f1_score(y_true = y_test, y_pred=y_pred) ##fl_score\n","roc_score = roc_auc_score(y_true = y_test, y_score=y_pred)\n","\n","print(f'정확도 : {acc:0.4f}', f'roc_score : {roc_score:0.4f}', f'f1 score:{f_score:0.4f}', sep=' | ')"],"metadata":{"id":"JypDT5P7Fg-p","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1658757565894,"user_tz":-540,"elapsed":14,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"7a4d1ce2-9c39-4e7f-8723-716112910d2e"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.5835 | roc_score : 0.5716 | f1 score:0.6824\n"]}]},{"cell_type":"code","source":["plot_confusion_matrix(svc_rbf, X_test, y_test, cmap=plt.cm.Blues)\n","plt.show()"],"metadata":{"id":"ujKZlU6gFg8Q","colab":{"base_uri":"https://localhost:8080/","height":279},"executionInfo":{"status":"ok","timestamp":1658758064469,"user_tz":-540,"elapsed":203000,"user":{"displayName":"민시온","userId":"03524457202412806393"}},"outputId":"872c7229-40ec-401b-833e-6136c890d2b4"},"execution_count":24,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":[""],"metadata":{"id":"7qUQb0c1Fgta"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"LUcZdeWGrHO3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["C=0.1\n","svc_rbf = SVC(random_state = 11, probability=True, kernel=\"rbf\", gamma='auto', C=C)\n","svc_poly = SVC(random_state = 11, probability=True, kernel='poly', degree=3, C=C)"],"metadata":{"id":"FM7ggBKNW2gK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["svc_rbf.fit(X_train, y_train)\n","svc_poly.fit(X_train, y_train)"],"metadata":{"id":"kjRslSdzW2dR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["C=1000\n","svc_rbf_h = SVC(random_state = 11, probability=True, kernel=\"rbf\", gamma='auto', C=C)\n","svc_poly_h = SVC(random_state = 11, probability=True, kernel='poly', degree=3, C=C)\n","svc_rbf_h.fit(X_train, y_train)\n","svc_poly_h.fit(X_train, y_train)"],"metadata":{"id":"OaKUgswkW2Y1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"QbnjulnNW2WW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"uCGMfc1qWO8W"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"VcpfKoABWO57"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ro6zE5ZRhxnC"},"outputs":[],"source":["recall = recall_score(y_true = y_test, y_pred=y_pred) ##민감도\n","precision = precision_score(y_true = y_test, y_pred=y_pred) ##정밀도\n","f_score = f1_score(y_true = y_test, y_pred=y_pred) ##fl_score\n","\n","print(f'정확도 : {acc:0.4f}', f'민감도 : {recall:0.4f}', f'정밀도:{precision:0.4f}', f'f1 score:{f_score:0.4f}', sep=' | ')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"N6a36Zwvhzkj"},"outputs":[],"source":["plot_confusion_matrix(best_svc, X_test, y_test, cmap=plt.cm.Blues)\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Xk3Mjy_Oh9oD"},"outputs":[],"source":["!pip install shap"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p6Liv1Y_h9mC"},"outputs":[],"source":["import shap"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZcsX99goh9j5"},"outputs":[],"source":["#Kernel SHAP사용 -> 테스트 세트 예측 변수 설명\n","explainer = shap.KernelExplainer(CV_svc.predict_proba, X_train, link=\"logit\")\n","shap_values = explainer.shap_values(X_test, nsamples=100)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VEkSaGq9h9h0"},"outputs":[],"source":["shap.force_plot(explainer.expected_value[0], shap_values[0][0,:], X_test.iloc[0,:], link=\"logit\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wNPGdx5Uh9fe"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Qo2eqfRxh9c3"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"goAAhej9fnuH"},"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hURNvxcefeKW"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DaTQEVivfeIS"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"7BPgceHvft-Q"},"outputs":[],"source":["svc = SVC(random_state = 2022, probability=True)\n","param_grid = [\n","               {'kernel': ['poly'], 'degree': [3], 'C': [0.1, 1000]},\n","               {'kernel': ['rbf'], 'gamma':['auto'], 'C': [0.1, 1000]},\n","              ]\n","scores = ['f1']\n","#{'kernel': ['linear'], 'C': [0.1, 1, 10, 100, 1000]},\n","#{'kernel': ['sigmoid'], 'gamma':['auto','scale'], 'C': [0.1, 1, 10, 100, 1000]}  'recall', ,5\n","for score in scores:\n","  print(\"# Tuning hyper-parmeters for %s\" %score)\n","  print()\n","\n","  CV_svc = GridSearchCV(estimator=svc, param_grid=param_grid, scoring = f'{score}_macro', cv=2, verbose=1, n_jobs=12)\n","  CV_svc.fit(X_train, y_train)\n","\n","  print(\"Best parameters set found on development set:\")\n","  print()\n","  print(CV_svc.best_params_)\n","  \n","  print(\"Grid scores on development set:\")\n","  print()\n","  means = CV_svc.cv_results_['mean_test_score']\n","  stds = CV_svc.cv_results_['std_test_score']\n","\n","  for mean, std, params in zip(means, stds, CV_svc.cv_results_['params']):\n","    print(\"%0.3f (+/-%0.03f) for %r\"\n","          %(mean, std*2, params))\n","  print()\n","\n","  print(\"The model is trained on the full development set.\")\n","  print(\"The scores are computed on the full evaluation set.\")\n","  print()\n","\n","  y_true, y_pred = y_test, CV_svc.predict(X_test)\n","  print(classification_report(y_true, y_pred))\n","  print()\n","\n","CV_svc = GridSearchCV(estimator=svc, param_grid=param_grid, cv=10, verbose=1, n_jobs=12)\n","CV_svc.fit(X_train, y_train)"]},{"cell_type":"code","source":[""],"metadata":{"id":"ntX3rjz5pSDK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"f0NHYV0KrBQR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"Hoxsnrbvr8Ax"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"c3e4SZDAsB03"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"SxjkAyTxsKpL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"RSXN4LhusQiT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"x4HC6-SKsZV8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"VMLqh8_TsfIT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"UOOCp1Icsn_D"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"uAi1asekstyI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"ev0hoMfds2kI"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"CBzPejZZs8bM"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"F-mFmfektHm_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"9hn5Lt1LtWHO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"pD7ZMRmBtWH8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"0dChdvhYtkvW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"MKVSS1-NtkwF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"PTgi-V1Rtzfh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"HRunjElytzgm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"_juC4XPAuCEa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"3HRpKWJIuCFQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"aaVop63muQp2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"vzhmIUhAuQqy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"UPEzinbouXvE"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"name":"서포트벡터머신(3년)","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyNN4JOOA7lU1O6YpsuvDXPB"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}